<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Basics · MicroMagnetic.jl</title><meta name="title" content="Basics · MicroMagnetic.jl"/><meta property="og:title" content="Basics · MicroMagnetic.jl"/><meta property="twitter:title" content="Basics · MicroMagnetic.jl"/><meta name="description" content="Documentation for MicroMagnetic.jl."/><meta property="og:description" content="Documentation for MicroMagnetic.jl."/><meta property="twitter:description" content="Documentation for MicroMagnetic.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><script src="../assets/init.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MicroMagnetic.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Basics</a><ul class="internal"><li><a class="tocitem" href="#Meshes"><span>Meshes</span></a></li><li><a class="tocitem" href="#Sim"><span>Sim</span></a></li><li><a class="tocitem" href="#Functions"><span>Functions</span></a></li><li><a class="tocitem" href="#Shapes"><span>Shapes</span></a></li><li><a class="tocitem" href="#Energy-Terms"><span>Energy Terms</span></a></li><li><a class="tocitem" href="#Driver"><span>Driver</span></a></li><li><a class="tocitem" href="#Periodic-Boundary-conditions"><span>Periodic Boundary conditions</span></a></li><li><a class="tocitem" href="#Timings"><span>Timings</span></a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Micromagnetics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../tutorials/micromagnetics/compute_energy/">Calculating micromagnetic energies</a></li><li><a class="tocitem" href="../tutorials/micromagnetics/nanobar/">Magnetization state of a nanobar</a></li><li><a class="tocitem" href="../tutorials/micromagnetics/vortex/">Magnetic vortex</a></li><li><a class="tocitem" href="../tutorials/micromagnetics/std4/">Micromagnetic Standard Problem 4</a></li><li><a class="tocitem" href="../tutorials/micromagnetics/std5/">Micromagnetic Standard Problem 5</a></li><li><a class="tocitem" href="../tutorials/micromagnetics/skyrmion_stt/">Skyrmion dynamics under spin transfer torques</a></li><li><a class="tocitem" href="../tutorials/micromagnetics/stoner_wohlfarth/">Stoner–Wohlfarth model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Atomistic</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../tutorials/atomistic/skyrmion/">Magnetic skyrmion</a></li><li><a class="tocitem" href="../tutorials/atomistic/skyrmion_afm/">Antiferromagnetic skyrmion</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Monte carlo</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../tutorials/monte_carlo/M_T_curve/">M-T curve using Monte Carlo</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Neb</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../tutorials/neb/neb_skx/">Skyrmion collapse using NEB</a></li></ul></li></ul></li><li><a class="tocitem" href="../equations/">Equations</a></li><li><a class="tocitem" href="../functions/">API</a></li><li><a class="tocitem" href="../developer/">Developers</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Basics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Basics</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ww1g11/MicroMagnetic.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/ww1g11/MicroMagnetic.jl/blob/master/docs/src/basics.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Basics"><a class="docs-heading-anchor" href="#Basics">Basics</a><a id="Basics-1"></a><a class="docs-heading-anchor-permalink" href="#Basics" title="Permalink"></a></h1><h2 id="Meshes"><a class="docs-heading-anchor" href="#Meshes">Meshes</a><a id="Meshes-1"></a><a class="docs-heading-anchor-permalink" href="#Meshes" title="Permalink"></a></h2><p>MicroMagnetic uses finite difference methods to discretize the micromagnetic energies. In MicroMagnetic, the discretized grid information  is stored in <a href="../functions/#MicroMagnetic.FDMesh"><code>FDMesh</code></a>. Therefore, before starting the simulation, we need to create a mesh.</p><pre><code class="language-julia hljs">mesh = FDMesh(;dx=1e-9, dy=1e-9, dz=1e-9, nx=1, ny=1, nz=1)</code></pre><p>In fact, <a href="../functions/#MicroMagnetic.FDMesh"><code>FDMesh</code></a> is used in our micromagnetic simulations, while for atomic models, we can use <a href="../functions/#MicroMagnetic.CubicMesh"><code>CubicMesh</code></a>, <a href="../functions/#MicroMagnetic.TriangularMesh"><code>TriangularMesh</code></a>, as well as <a href="../functions/#MicroMagnetic.CylindricalTubeMesh"><code>CylindricalTubeMesh</code></a>, etc.</p><div class="mermaid">
graph LR;
    Mesh --> FDMesh
    Mesh --> AtomisticMesh
    AtomisticMesh --> TriangularMesh
    AtomisticMesh --> SquareMesh
    AtomisticMesh --> CubicMesh
    AtomisticMesh --> CylindricalTubeMesh
</div><h2 id="Sim"><a class="docs-heading-anchor" href="#Sim">Sim</a><a id="Sim-1"></a><a class="docs-heading-anchor-permalink" href="#Sim" title="Permalink"></a></h2><p>In MicroMagnetic, we can create different Sim objects based on the computational system or problem type. MicroMagnetic defines four types of Sims:</p><div class="mermaid">
graph LR
   AbstractSim --> MicroSim
   AbstractSim --> AtomisticSim
   AbstractSim --> NEB
   AbstractSim --> MonteCarlo
</div><p>For <a href="../functions/#MicroMagnetic.MicroSim">MicroSim</a> and <a href="../functions/#MicroMagnetic.AtomisticSim">AtomisticSim</a>, we recommend using the <a href="../functions/#MicroMagnetic.create_sim"><code>create_sim</code></a> function to create them, as the <a href="../functions/#MicroMagnetic.create_sim"><code>create_sim</code></a> function  can specify some parameters while creating Sim. Of course, these parameters can also be specified later. </p><pre><code class="language-julia hljs">sim = create_sim(mesh)</code></pre><p>Note: all simulation data can be obtained through sim, especially, we can obtain the magnetization distribution state of the system through <code>sim.spin</code> at any time.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>By default, the magnetization is stored in a 1D array with the form <span>$[m_{1,x}, m_{1, y}, m_{1, z}, ..., m_{n,x}, m_{n, y}, m_{n, z}]$</span>, which can be reshaped into a 4D array</p><pre><code class="language-julia hljs">m = reshape(sim.spin, 3, nx, ny, nz)
mx = m[1, :, :, :]
my = m[2, :, :, :]
mz = m[3, :, :, :]</code></pre></div></div><h2 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h2><p>In MicroMagnetic, all parameters can be set using functions. For example, we can use the <a href="../functions/#MicroMagnetic.set_Ms"><code>set_Ms</code></a> function to set the saturation magnetization of the system. Of course, Ms should be a scalar for the same material, and we can set it like this:</p><pre><code class="language-julia hljs">set_Ms(sim, 8.6e5)</code></pre><p>Additionally, we can set it with a function, like this:</p><pre><code class="nohighlight hljs">function circular_Ms(i,j,k,dx,dy,dz)
    if (i-50.5)^2 + (j-50.5)^2 &lt;= 50^2
        return 8.6e5
    end
    return 0.0
end
set_Ms(sim, circular_Ms)</code></pre><p>Note that the Mesh we create is actually a regular cuboid, but in reality, the shape of the sample is not necessarily a cuboid. At this time, we define a round disk,  where its Ms is 0 outside the disk. In this way, we can define the shape of the simulation system. Please note that in MicroMagnetic, almost all setting functions can  accept a function as input. This cell-based approach maximizes flexibility, allowing for defining shapes, defining multiple materials, etc.</p><h2 id="Shapes"><a class="docs-heading-anchor" href="#Shapes">Shapes</a><a id="Shapes-1"></a><a class="docs-heading-anchor-permalink" href="#Shapes" title="Permalink"></a></h2><h3 id="Basic-Shapes"><a class="docs-heading-anchor" href="#Basic-Shapes">Basic Shapes</a><a id="Basic-Shapes-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Shapes" title="Permalink"></a></h3><p>In addition to using functions to define shapes, for some regular shapes and their combinations, we can use basic shapes and boolean operations defined in MicroMagnetic to achieve this. MicroMagnetic supports Plane, Cylinder, Sphere, Box, and Torus, etc., as basic shapes.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><table><tr><th style="text-align: center"><strong>operator</strong></th><th style="text-align: center"><strong>Boolean operation</strong></th></tr><tr><td style="text-align: center">+</td><td style="text-align: center">Union</td></tr><tr><td style="text-align: center">-</td><td style="text-align: center">Difference</td></tr><tr><td style="text-align: center">*</td><td style="text-align: center">Intersection</td></tr></table></div></div><p>Example:</p><pre><code class="language-julia hljs">using MicroMagnetic

mesh = FDMesh(dx=2e-9, dy=2e-9, dz=2e-9, nx=100, ny=100, nz=50)

p1 = Plane(point=(40e-9,0,0), normal=(1, 0, 0))
save_vtk(mesh, p1, &quot;shape1&quot;)

c1 = Cylinder(radius=30e-9, normal=(0.3,0,1))
save_vtk(mesh, c1, &quot;shape2&quot;)

s1 = Sphere(radius = 30e-9, center=(50e-9, 0, 0))
save_vtk(mesh, s1, &quot;shape3&quot;)

b1 = Box(sides = (110e-9, 50e-9, Inf), theta=pi/4)
save_vtk(mesh, b1, &quot;shape4&quot;)

t1 = Torus(R = 60e-9, r=20e-9)
save_vtk(mesh, t1, &quot;shape5&quot;)

t2 = t1 - b1 
save_vtk(mesh, t2, &quot;shape6&quot;)

t3 = t1 * b1 
save_vtk(mesh, t3, &quot;shape7&quot;)

t4 = t1 - p1 + (s1 * p1)
save_vtk(mesh, t4, &quot;shape8&quot;)</code></pre><p>The saved vts files can be visualized using programs such as Paraview, as shown below:</p><p><img src="../figures/shapes.png" alt="shapes"/></p><p>The created shapes can be used to set parameters, such as</p><pre><code class="language-julia hljs">set_Ms(sim::AbstractSim, geo::Shape, Ms::Number)</code></pre><h3 id="Custom-Shapes"><a class="docs-heading-anchor" href="#Custom-Shapes">Custom Shapes</a><a id="Custom-Shapes-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-Shapes" title="Permalink"></a></h3><p>We can also define custom shapes using the <code>create_shape</code> function. Custom shapes can also be combined with basic shapes using boolean operations.</p><h2 id="Energy-Terms"><a class="docs-heading-anchor" href="#Energy-Terms">Energy Terms</a><a id="Energy-Terms-1"></a><a class="docs-heading-anchor-permalink" href="#Energy-Terms" title="Permalink"></a></h2><p>After creating Sim, we can call functions to add energy terms that need to be considered in the simulation. For example, add<em>zeeman, add</em>exch, add<em>dmi, add</em>demag  correspondingly add Zeeman energy, exchange interaction energy, DMI, and demagnetization energy.</p><p>Note</p><pre><code class="language-julia hljs">sim = create_sim(mesh, Ms=8e5, A=1.3e-11)</code></pre><p>and</p><pre><code class="language-julia hljs">sim = create_sim(mesh)
set_Ms(sim, Ms=8e5)

ex = add_exch(sim, A=1.3e-11)</code></pre><p>are equivalent. The advantage of the latter is that when we need exchange interaction data, we can directly access it through  <code>ex</code>.</p><p>MicroMagnetic implements energy terms </p><div class="mermaid">
graph TD;
    MicroEnergy --> Exchange
    Exchange --> UniformExchange
    Exchange --> SpatialExchange
    Exchange --> ExchangeRKKY
    MicroEnergy --> BulkDMI
    MicroEnergy --> SpatialBulkDMI
    MicroEnergy --> Zeeman
    MicroEnergy --> Anisotropy
    MicroEnergy --> CubicAnisotropy
    MicroEnergy --> StochasticField    
</div><h2 id="Driver"><a class="docs-heading-anchor" href="#Driver">Driver</a><a id="Driver-1"></a><a class="docs-heading-anchor-permalink" href="#Driver" title="Permalink"></a></h2><div class="mermaid">
graph LR;
    Driver --> LLG
    Driver --> LLG_STT
    Driver --> EnergyMinimization
</div><h2 id="Periodic-Boundary-conditions"><a class="docs-heading-anchor" href="#Periodic-Boundary-conditions">Periodic Boundary conditions</a><a id="Periodic-Boundary-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Periodic-Boundary-conditions" title="Permalink"></a></h2><h2 id="Timings"><a class="docs-heading-anchor" href="#Timings">Timings</a><a id="Timings-1"></a><a class="docs-heading-anchor-permalink" href="#Timings" title="Permalink"></a></h2><p>In MicroMagnetic.jl, we make use of TimerOutputs.jl to measure execution time in various tasks. After running the simulation,  the measured times are stored in <code>MicroMagnetic.timer</code>, so we can simply use </p><pre><code class="language-julia hljs">println(MicroMagnetic.timer)</code></pre><p>to display the timing information. A typical output is shown below:</p><pre><code class="language-bash hljs"> ────────────────────────────────────────────────────────────────────────────────────
                                            Time                    Allocations
                                   ───────────────────────   ────────────────────────
         Tot / % measured:              16.1s /  82.8%            705MiB /  92.4%

 Section                   ncalls     time    %tot     avg     alloc    %tot      avg
 ────────────────────────────────────────────────────────────────────────────────────
 run_until                    101    12.8s   95.8%   127ms    632MiB   97.1%  6.26MiB
   demag                    25.1k    8.83s   66.2%   351μs    341MiB   52.4%  13.9KiB
   exch                     25.1k    780ms    5.8%  31.0μs   72.5MiB   11.1%  2.95KiB
   zeeman                   25.1k    523ms    3.9%  20.8μs   46.0MiB    7.1%  1.87KiB
   compute_system_energy      101   42.3ms    0.3%   419μs   1.93MiB    0.3%  19.5KiB
 run_step                     366    322ms    2.4%   880μs   12.7MiB    2.0%  35.6KiB
   demag                      366    191ms    1.4%   521μs   5.60MiB    0.9%  15.7KiB
   exch                       366   20.2ms    0.2%  55.3μs   1.12MiB    0.2%  3.14KiB
 compute_system_energy        367    232ms    1.7%   632μs   6.41MiB    1.0%  17.9KiB
 ────────────────────────────────────────────────────────────────────────────────────</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../tutorials/micromagnetics/compute_energy/">Calculating micromagnetic energies »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Tuesday 2 July 2024 14:53">Tuesday 2 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
